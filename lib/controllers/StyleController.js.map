{"version":3,"file":"StyleController.js","sources":["../../src/controllers/StyleController.ts"],"sourcesContent":["import { NineSliceSprite, TilingSprite } from 'pixi.js';\nimport { LayoutSystem } from '../Layout';\nimport { BACKGROUND_SIZE, OVERFLOW, VERTICAL_ALIGN } from '../utils/constants';\nimport { stylesToPixiTextStyles } from '../utils/helpers';\nimport { PixiTextStyle } from '../utils/text';\n\nimport type { ConditionalStyles, GradeToOne, Styles } from '../utils/types';\n\n/** Style controller manages {@link LayoutSystem} styles. */\nexport class StyleController\n{\n    protected layout: LayoutSystem;\n\n    protected styles: Styles = {};\n\n    /** Holds all text related styles. This is to be nested by children */\n    protected _textStyle: Partial<PixiTextStyle> = {}; // this is to be nested by children\n\n    /** Stores default styles. */\n    protected defaultStyles: Styles;\n\n    /** Conditional styles */\n    protected conditionalStyles: ConditionalStyles = {};\n\n    /**\n     * Manages and sets all the styles of {@link LayoutSystem}\n     * @param layout - {@link LayoutSystem} to be styled\n     * @param styles - styles to be applied\n     */\n    constructor(layout: LayoutSystem, styles?: Styles)\n    {\n        this.layout = layout;\n        this.set(styles);\n    }\n\n    /**\n     * Applies a list of styles for the layout.\n     * @param { Styles } styles - styles to be applied\n     */\n    set(styles?: Styles & ConditionalStyles)\n    {\n        this.styles.overflow\n            = styles?.overflow ?? this.styles.overflow ?? OVERFLOW[0];\n        this.styles.display\n            = styles?.display ?? this.styles.display ?? 'inline-block';\n        this.styles.borderRadius\n            = styles?.borderRadius ?? this.styles.borderRadius ?? 0;\n\n        this.styles.zIndex = styles?.zIndex ?? this.styles.zIndex ?? 1;\n\n        this.opacity = styles?.opacity ?? this.styles.opacity ?? 1;\n\n        this.styles.maxWidth = styles?.maxWidth ?? this.styles.maxWidth;\n        this.styles.maxHeight = styles?.maxHeight ?? this.styles.maxHeight;\n\n        this.styles.minWidth = styles?.minWidth ?? this.styles.minWidth;\n        this.styles.minHeight = styles?.minHeight ?? this.styles.minHeight;\n\n        this.styles.padding = styles?.padding ?? this.styles.padding ?? 0;\n        this.styles.paddingTop\n            = styles?.paddingTop\n            ?? styles?.padding\n            ?? this.styles.paddingTop\n            ?? 0;\n        this.styles.paddingRight\n            = styles?.paddingRight\n            ?? styles?.padding\n            ?? this.styles.paddingRight\n            ?? 0;\n        this.styles.paddingBottom\n            = styles?.paddingBottom\n            ?? styles?.padding\n            ?? this.styles.paddingBottom\n            ?? 0;\n        this.styles.paddingLeft\n            = styles?.paddingLeft\n            ?? styles?.padding\n            ?? this.styles.paddingLeft\n            ?? 0;\n\n        this.styles.margin = styles?.margin ?? this.styles.margin ?? 0;\n        this.styles.marginTop\n            = styles?.marginTop ?? styles?.margin ?? this.styles.marginTop ?? 0;\n        this.styles.marginRight\n            = styles?.marginRight\n            ?? styles?.margin\n            ?? this.styles.marginRight\n            ?? 0;\n        this.styles.marginBottom\n            = styles?.marginBottom\n            ?? styles?.margin\n            ?? this.styles.marginBottom\n            ?? 0;\n        this.styles.marginLeft\n            = styles?.marginLeft ?? styles?.margin ?? this.styles.marginLeft ?? 0;\n\n        this.styles.scale = styles?.scale ?? this.styles.scale ?? 1;\n        this.styles.scaleX\n            = styles?.scaleX ?? styles?.scale ?? this.styles.scaleX ?? 1;\n        this.styles.scaleY\n            = styles?.scaleY ?? styles?.scale ?? this.styles.scaleY ?? 1;\n\n        this.styles.width = styles?.width ?? this.styles.width ?? 'auto';\n        this.styles.height = styles?.height ?? this.styles.height ?? 'auto';\n\n        this.styles.wordWrap = styles?.wordWrap ?? false;\n\n        if (styles?.anchorX !== undefined)\n        {\n            this.styles.anchorX = styles.anchorX;\n        }\n        else if (styles?.anchor !== undefined)\n        {\n            if (typeof styles.anchor === 'number')\n            {\n                this.styles.anchorX = styles.anchor;\n            }\n            else if (Array.isArray(styles.anchor))\n            {\n                this.styles.anchorX = styles.anchor[0];\n            }\n        }\n\n        if (styles?.anchorY !== undefined)\n        {\n            this.styles.anchorY = styles.anchorY;\n        }\n        else if (styles?.anchor !== undefined)\n        {\n            if (typeof styles.anchor === 'number')\n            {\n                this.styles.anchorY = styles.anchor;\n            }\n            else if (\n                Array.isArray(styles.anchor)\n                && styles.anchor[1] !== undefined\n            )\n            {\n                this.styles.anchorY = styles.anchor[1];\n            }\n        }\n\n        this.styles.background\n            = styles?.background\n            ?? styles?.backgroundColor\n            ?? this.styles.background;\n\n        this.styles.backgroundSize\n            = styles?.backgroundSize\n            ?? this.styles.backgroundSize\n            ?? BACKGROUND_SIZE[0];\n\n        if (\n            this.styles.background instanceof NineSliceSprite\n            || this.styles.background instanceof TilingSprite\n        )\n        {\n            this.styles.backgroundSize = 'stretch';\n        }\n\n        this.styles.textAlign = styles?.textAlign ?? this.styles.textAlign;\n        this.styles.position = styles?.position ?? this.styles.position;\n        this.styles.verticalAlign\n            = styles?.verticalAlign\n            ?? this.styles.verticalAlign\n            ?? VERTICAL_ALIGN[0];\n\n        this.styles.aspectRatio\n            = styles?.aspectRatio ?? this.styles.aspectRatio ?? 'static';\n\n        this.styles.visible = styles?.visible ?? this.styles.visible ?? true;\n        this.visible = this.styles.visible;\n\n        this._textStyle = stylesToPixiTextStyles(styles);\n\n        if (styles)\n        {\n            this.separateConditionalStyles(styles);\n        }\n    }\n\n    /**\n     * Returns a style value by name.\n     * @param style - name of the style\n     */\n    get(style: keyof Styles): Styles[keyof Styles]\n    {\n        return this.styles[style];\n    }\n\n    /** Returns all styles of the Layout */\n    getAll(): Styles\n    {\n        return this.styles;\n    }\n\n    /** Returns all pixi text related styles of the Layout */\n    get textStyle(): Partial<PixiTextStyle>\n    {\n        return this._textStyle;\n    }\n\n    /** Sets the opacity of the layout */\n    set opacity(value: GradeToOne)\n    {\n        this.styles.opacity = value;\n        this.layout.container.alpha = value;\n    }\n\n    /** Returns the opacity of the layout */\n    get opacity(): GradeToOne\n    {\n        return this.styles.opacity;\n    }\n\n    /** Set visibility of the layout */\n    set visible(value: boolean)\n    {\n        this.layout.container.visible = value;\n    }\n\n    /** Returns visibility of the layout */\n    get visible(): boolean\n    {\n        return this.layout.container.visible;\n    }\n\n    /** Checks and applies conditional styles basing on parent size */\n    applyConditionalStyles()\n    {\n        if (!this.hasConditionalStyles) return;\n\n        this.set({\n            ...this.defaultStyles,\n            ...(this.layout.isRootLayoutPortrait\n                ? this.conditionalStyles.portrait\n                : this.conditionalStyles.landscape),\n        });\n    }\n\n    /**\n     * Separates conditional styles from default styles\n     * @param styles - mixed styles\n     */\n    protected separateConditionalStyles(styles?: Styles & ConditionalStyles)\n    {\n        if (!styles.portrait && !styles.landscape)\n        {\n            this.defaultStyles = {\n                ...styles,\n            };\n\n            return;\n        }\n\n        if (styles.portrait)\n        {\n            this.conditionalStyles.portrait = {\n                ...this.conditionalStyles.portrait,\n                ...styles.portrait,\n            };\n        }\n\n        if (styles.landscape)\n        {\n            this.conditionalStyles.landscape = {\n                ...this.conditionalStyles.landscape,\n                ...styles.landscape,\n            };\n        }\n\n        delete styles.portrait;\n        delete styles.landscape;\n\n        this.defaultStyles = styles;\n    }\n\n    /** Returns true if there are conditional styles */\n    get hasConditionalStyles(): boolean\n    {\n        return Object.keys(this.conditionalStyles).length > 0;\n    }\n}\n"],"names":["OVERFLOW","BACKGROUND_SIZE","NineSliceSprite","TilingSprite","VERTICAL_ALIGN","stylesToPixiTextStyles"],"mappings":"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"}